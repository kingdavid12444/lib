-- Roblox Modern UI Library v4.0
-- Adds Tween animations, dropdowns, improved UX

local Players            = game:GetService("Players")
local TweenService       = game:GetService("TweenService")
local RunService         = game:GetService("RunService")
local UserInputService   = game:GetService("UserInputService")

local UILib = {}
UILib.__index = UILib

-- Utility: apply rounded corners, strokes
local function applyCornerStroke(inst)
    Instance.new("UICorner", inst).CornerRadius = UDim.new(0,8)
    local stroke = Instance.new("UIStroke", inst)
    stroke.Color = Color3.fromRGB(0,0,0)
    stroke.Transparency = 0.5
end

-- Utility: style Buttons with hover tweens
local function styleButton(btn)
    btn.BackgroundColor3 = Color3.fromRGB(45,45,45)
    btn.TextColor3       = Color3.new(1,1,1)
    btn.Font             = Enum.Font.GothamBold
    btn.TextSize         = 14
    btn.BorderSizePixel  = 0
    applyCornerStroke(btn)
    btn.MouseEnter:Connect(function()
        TweenService:Create(btn, TweenInfo.new(0.15), {BackgroundColor3 = Color3.fromRGB(60,60,60)}):Play()
    end)
    btn.MouseLeave:Connect(function()
        TweenService:Create(btn, TweenInfo.new(0.15), {BackgroundColor3 = Color3.fromRGB(45,45,45)}):Play()
    end)
end

-- CreateWindow: initializes the GUI and top dock
function UILib:CreateWindow(title)
    local player = Players.LocalPlayer
    local gui = Instance.new("ScreenGui")
    gui.Name         = title or "ModernUILib"
    gui.ResetOnSpawn = false
    gui.Parent       = player:WaitForChild("PlayerGui")
    self._gui = gui

    -- Top Dock
    local dock = Instance.new("Frame", gui)
    dock.Name             = "TopDock"
    dock.Size             = UDim2.new(1,0,0,40)
    dock.Position         = UDim2.new(0,0,0,0)
    dock.BackgroundColor3 = Color3.fromRGB(25,25,25)
    dock.BorderSizePixel  = 0
    applyCornerStroke(dock)

    local layout = Instance.new("UIListLayout", dock)
    layout.FillDirection       = Enum.FillDirection.Horizontal
    layout.Padding             = UDim.new(0,8)
    layout.HorizontalAlignment = Enum.HorizontalAlignment.Left
    layout.VerticalAlignment   = Enum.VerticalAlignment.Center

    self._dock = dock
    return setmetatable(self, UILib)
end

-- CreateTab: adds a dock button and animated mini window
function UILib:CreateTab(name)
    assert(self._gui and self._dock, "Call CreateWindow first")

    -- Tab Button
    local btn = Instance.new("TextButton", self._dock)
    btn.Name = name .. "_Button"
    btn.Size = UDim2.new(0,100,1,-8)
    btn.Text = name
    styleButton(btn)

    -- Floating window
    local win = Instance.new("Frame", self._gui)
    win.Name = name .. "_Window"
    win.Size = UDim2.new(0,280,0,360)
    win.Position = UDim2.new(0,16,0,50) -- offscreen initially
    win.BackgroundColor3 = Color3.fromRGB(35,35,35)
    win.BorderSizePixel = 0
    win.Visible = false
    win.Active = true
    win.Draggable = true
    applyCornerStroke(win)

    -- Title Bar
    local titleBar = Instance.new("Frame", win)
    titleBar.Size = UDim2.new(1,0,0,30)
    titleBar.BackgroundTransparency = 1
    local titleLbl = Instance.new("TextLabel", titleBar)
    titleLbl.Size = UDim2.new(1,-16,1,0)
    titleLbl.Position = UDim2.new(0,8,0,0)
    titleLbl.BackgroundTransparency = 1
    titleLbl.Text = name
    titleLbl.Font = Enum.Font.GothamBold
    titleLbl.TextSize = 18
    titleLbl.TextColor3 = Color3.fromRGB(245,245,245)
    titleLbl.TextXAlignment = Enum.TextXAlignment.Left

    -- Content container
    local content = Instance.new("ScrollingFrame", win)
    content.Name = "Content"
    content.Size = UDim2.new(1,-16,1,-46)
    content.Position = UDim2.new(0,8,0,38)
    content.BackgroundTransparency = 1
    content.ScrollBarThickness = 6
    content.CanvasSize = UDim2.new(0,0,0,0)
    local list = Instance.new("UIListLayout", content)
    list.SortOrder = Enum.SortOrder.LayoutOrder
    list.Padding   = UDim.new(0,8)

    -- Toggle visibility with slide animation
    btn.MouseButton1Click:Connect(function()
        if win.Visible then
            -- slide up
            TweenService:Create(win, TweenInfo.new(0.3), {Position = UDim2.new(0,16,0,-win.Size.Y.Offset)}):Play()
            wait(0.3)
            win.Visible = false
        else
            win.Position = UDim2.new(0,16,0,-win.Size.Y.Offset)
            win.Visible = true
            -- slide down
            TweenService:Create(win, TweenInfo.new(0.3), {Position = UDim2.new(0,16,0,50)}):Play()
        end
    end)

    -- API
    local api = {}
    function api:AddButton(txt, cb)
        local b = Instance.new("TextButton", content)
        b.Size = UDim2.new(1,0,0,30)
        b.Text = txt
        styleButton(b)
        b.MouseButton1Click:Connect(cb)
    end
    function api:AddLabel(txt)
        local lbl = Instance.new("TextLabel", content)
        lbl.Size = UDim2.new(1,0,0,24)
        lbl.BackgroundTransparency = 1
        lbl.Text = txt
        lbl.Font = Enum.Font.Gotham
        lbl.TextSize = 14
        lbl.TextColor3 = Color3.fromRGB(225,225,225)
    end
    function api:AddToggle(txt, cb)
        local frame = Instance.new("Frame", content)
        frame.Size = UDim2.new(1,0,0,30)
        frame.BackgroundTransparency = 1
        local lbl = Instance.new("TextLabel", frame)
        lbl.Size = UDim2.new(0.7,0,1,0)
        lbl.BackgroundTransparency = 1
        lbl.Text = txt
        lbl.Font = Enum.Font.Gotham
        lbl.TextSize = 14
        lbl.TextColor3 = Color3.fromRGB(225,225,225)
        local tog = Instance.new("TextButton", frame)
        tog.Size = UDim2.new(0,40,0,24)
        tog.Position = UDim2.new(1,-44,0,3)
        tog.Text = "OFF"
        styleButton(tog)
        local state = false
        tog.MouseButton1Click:Connect(function()
            state = not state
            tog.Text = state and "ON" or "OFF"
            -- toggle tween
            TweenService:Create(tog, TweenInfo.new(0.2), {BackgroundColor3 = state and Color3.fromRGB(0,170,0) or Color3.fromRGB(170,0,0)}):Play()
            cb(state)
        end)
    end
    function api:AddSlider(txt, min, max, cb)
        local frame = Instance.new("Frame", content)
        frame.Size = UDim2.new(1,0,0,60)
        frame.BackgroundTransparency = 1
        local lbl = Instance.new("TextLabel", frame)
        lbl.Size = UDim2.new(1,0,0,20)
        lbl.BackgroundTransparency = 1
        lbl.Text = txt..": "..min
        lbl.Font = Enum.Font.Gotham
        lbl.TextSize = 14
        lbl.TextColor3 = Color3.fromRGB(225,225,225)
        -- track
        local track = Instance.new("Frame", frame)
        track.Size = UDim2.new(1,-20,0,6)
        track.Position = UDim2.new(0,10,0,30)
        track.BackgroundColor3 = Color3.fromRGB(60,60,60)
        applyCornerStroke(track)
        -- fill
        local fill = Instance.new("Frame", track)
        fill.Size = UDim2.new(0,0,1,0)
        fill.BackgroundColor3 = Color3.fromRGB(142,68,173)
        applyCornerStroke(fill)
        -- knob
        local knob = Instance.new("Frame", track)
        knob.Size = UDim2.new(0,14,0,14)
        knob.AnchorPoint = Vector2.new(0.5,0.5)
        knob.Position = UDim2.new(0,0,0.5,0)
        knob.BackgroundColor3 = Color3.fromRGB(245,245,245)
        applyCornerStroke(knob)

        local dragging = false
        track.InputBegan:Connect(function(i) if i.UserInputType==Enum.UserInputType.MouseButton1 then dragging=true end end)
        UserInputService.InputEnded:Connect(function(i) if i.UserInputType==Enum.UserInputType.MouseButton1 then dragging=false end end)
        RunService.RenderStepped:Connect(function()
            if dragging then
                local mx = UserInputService:GetMouseLocation().X
                local x0 = track.AbsolutePosition.X
                local w0 = track.AbsoluteSize.X
                local pct = math.clamp((mx-x0)/w0,0,1)
                -- tween fill & knob
                TweenService:Create(fill, TweenInfo.new(0.05), {Size = UDim2.new(pct,0,1,0)}):Play()
                TweenService:Create(knob, TweenInfo.new(0.05), {Position = UDim2.new(pct,0,0.5,0)}):Play()
                local val = math.floor(min + pct*(max-min)+0.5)
                lbl.Text = txt..": "..val
                cb(val)
            end
        end)
    end
    function api:AddDropdown(txt, options, cb)
        local frame = Instance.new("Frame", content)
        frame.Size = UDim2.new(1,0,0,30)
        frame.BackgroundTransparency = 1
        local lbl = Instance.new("TextLabel", frame)
        lbl.Size = UDim2.new(0.5,0,1,0)
        lbl.BackgroundTransparency = 1
        lbl.Text = txt
        lbl.Font = Enum.Font.Gotham
        lbl.TextSize = 14
        lbl.TextColor3 = Color3.fromRGB(225,225,225)
        local cur = Instance.new("TextButton", frame)
        cur.Size = UDim2.new(0.5,-10,1,0)
        cur.Position = UDim2.new(0.5,10,0,0)
        cur.Text = options[1]
        styleButton(cur)
        local drop = Instance.new("Frame", frame)
        drop.Size = UDim2.new(0.5,-10,0,0)
        drop.Position = UDim2.new(0.5,10,1,0)
        drop.BackgroundColor3 = Color3.fromRGB(45,45,45)
        applyCornerStroke(drop)
        drop.ClipsDescendants = true
        local listLayout = Instance.new("UIListLayout", drop)
        listLayout.SortOrder = Enum.SortOrder.LayoutOrder

        for i,opt in ipairs(options) do
            local btn = Instance.new("TextButton", drop)
            btn.Size = UDim2.new(1,0,0,30)
            btn.Text = opt
            btn.Font = Enum.Font.Gotham
            btn.TextSize = 14
            btn.TextColor3 = Color3.new(1,1,1)
            btn.BackgroundTransparency = 1
            btn.MouseButton1Click:Connect(function()
                cur.Text = opt
                cb(opt)
                TweenService:Create(drop, TweenInfo.new(0.2), {Size = UDim2.new(0.5,-10,0,0)}):Play()
            end)
        end
        cur.MouseButton1Click:Connect(function()
            local expanded = drop.Size.Y.Offset > 0
            local newSize = expanded and 0 or #options*30
            TweenService:Create(drop, TweenInfo.new(0.2), {Size = UDim2.new(0.5,-10,0,newSize)}):Play()
        end)
    end

    return api
end

return UILib
 
